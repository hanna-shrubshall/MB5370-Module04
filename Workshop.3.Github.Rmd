---
title: "Workshop.3.Github"
output: html_document
date: "2023-05-04"
Author: Hanna Shurbshall 
---
#2.0 Workshop 1: Dataviv in R 

##2.1 Installing the tidyverse
```{r}
install.packages("tidyverse")
library(tidyverse)
```

##2.5 Obtain the data 
```{r}
mpg
```
##2.6 Create your first ggplot 
- ggplot() creates a coordinate system   that you can add layers to 
- the function "data =" is where you     input your dataset being used for the   plot
- geom_point() addds a layer of points   to your plots which creates a          scatterplot. 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))
```
##2.7 Understand the 'grammar of graphics' 
###2.7.1 Graphing template 
- A general template for ggplot is to 'call ggplot, offer it data, then provide a geom function with a collection of mappings, which dictate how you plot will look' 
- The template is below 
```{r}
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```

###2.7.2 Aesthetic mappings 
- This refers to the size, shape and colour of data points 
- You need to attributes of a plot a geom and aesthetic 
Example, change point colour by class: 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, colour = class))
```
Example, change point size by class: 
NOTE: Using size for a discrete variable is not advised. 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, size = class))
```
Example, change point transparency by class (alpha):
- The alpha aesthetic is whats changing transparency 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, alpha = class))
```
Example, change point shape by class: 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
```

Examples, things can also be set manually, like points colour: 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = "purple")
```
Example question to try: What happens if you map an aesthetic to something other than a variable na,e, like aes(colour = displ <5)? 
- It's interesting to note that any number above 5 is coloured orange, where as any colour below 5 is coloured blue. 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy, colour = displ <5))
```
##2.9 Facet and panel plots 
- This section allows you to develop separate plots for a range of reasons, most often to show a subset of data
- The function used for this is facet_wrap()
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))+ facet_wrap(~class,nrow = 2)
```
Example with more than one variable: 
- Function is facet_grid()
- Use ~ to separate variables 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))+ facet_grid(drv~cyl)
```
Example using a . to produce plots without rows or column dimensions: 
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy))+ facet_grid(.~cyl)
```
Exercise: 
What does nrow do? 
This dictates the number of rows there are 
what does ncol do? 
This dictates the number of columns there are 
What other options control the layout of the individual panels? 
The function as.table lays the facets out as a table if TRUE with the highest values at the bottom right. if FALSE the facets are laid out like a plot with the highest value at the top right. 

##2.10 Fitting simple lines
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy)) 
```
Example, display the same data as a smooth line fir through the points using geom_smooth()
```{r}
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy))
```
```{r}
ggplot(data = mpg) + 
#  geom_point(mapping = aes(x = displ, y = hwy))#points horrible
  geom_smooth(mapping = aes(x = displ, y = hwy))#try mooth line
```

Example, changing the line type: 
```{r}
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy, linetype = drv))
```

Example, set a group aesthetic to a categorical variable to draw multiple objects: 
- using a group argument to show that the data is in fact grouped - it won't add a new legend but can easily be used to vary your plots by discrete variables. 
```{r}
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy, group = drv))
```
Example, change the colour of each line based on drv value: 
```{r}
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy, colour = drv), show.legend = FALSE)
```

Example, plotting multiple geoms on the single plot: 
```{r}
ggplot(data = mpg) + 
  geom_smooth(mapping = aes(x = displ, y = hwy))+
  geom_point(mapping = aes(x = displ, y = hwy))
```

Example, creating the same plot as above, BUT in a more effcient manner: 
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy))+
  geom_point()+
  geom_smooth()
```

Example, using mappings in specific layers to enable the display of different aesthetics in different layers: 
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy))+
  geom_point(mapping = aes(color = class))+
  geom_smooth()
```

Example, specify different data for each layer, here a filter is used to select a subset of data and plot only that subset (class = "subcompact"): 
```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy))+
  geom_point(mapping = aes(color = class))+
  geom_smooth(data = filter(mpg, class =="subcompact"), se = FALSE)
```

Exercise:
1. What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?
- geom_smooth 
- geom_boxplot
- geom_histogram
- geom_area 

2. Run this code in your head and predict what the output will look like. Then, run the code in R and check your predictions.
- it will produce points and line data 

3. Will these two graphs look different? Why/why not?
These two graphs will look the same because the first set of cod is  the more efficient way to write the second lot of code. Hence, they will produce the same map. 

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth()

ggplot() + 
  geom_point(data = mpg, mapping = aes(x = displ, y = hwy)) + 
  geom_smooth(data = mpg, mapping = aes(x = displ, y = hwy))
```
##2.11 Transformations and Stats
The following is going to be using a different data set 
- The diamonds dataset comes in ggplot2 and contains information about ~54,000 diamonds, including the price, carat, color, clarity and cut of each diamond 

###2.11.1 Plotting statistics
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut))
```

- bar charts, histograms, and frequency polygons bin your data and then plot bin counts, the number of points that fall in each bin.
- smoothers fit a model to your data and then plot predictions from the model.
- boxplots compute a robust summary of the distribution and then display a specially formatted box.

The algorithm used to calculate new values for a graph is called a stat, short for statistical transformation. 

Example, using geoms and stats interchangeably: 
```{r}
ggplot(data = diamonds) + 
  stat_count(mapping = aes(x = cut))
```
###2.11.2 Overriding defaults in ggpplot2

Example, understanding how to override a default stat: 
```{r}
demo <- tribble(
  ~cut,         ~freq,
  "Fair",       1610,
  "Good",       4906,
  "Very Good",  12082,
  "Premium",    13791,
  "Ideal",      21551
)
demo

ggplot(data = demo) +
  geom_bar(mapping = aes(x = cut, y = freq), stat = "identity")
```
Example, overriding a default mapping from transformed variables to aesthetics (displaying a bar chart of proportion of your total diamond data set rather than a count): 
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = after_stat(prop), group = 1))
```
###2.11.3 Plotting statistical details 
Example, understanding more about these transformations in your plot: using stat_summary()
```{r}
ggplot(data = diamonds) + 
  stat_summary(
    mapping = aes(x = cut, y = depth),
    fun.min = min,
    fun.max = max,
    fun = median
  )
```
Example, you need to set the group = x number, otherwise the plots data will be represented as the same. 
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, y = after_stat(prop)))
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = color, y = after_stat(prop)))
```
##2.12 Positional adjustments 
Example using colour or fill to change aspects of bar colours 
- The first graph has coloured borders where as the second is filled in 
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, colour = cut))
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = cut))
```
Example, using these aesthetics to colour by clarity: 
- the stacking is done automatically 
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity))
```
Position adjustments allow you to customise plots in 3 ways: 
1. identity (raw data)
2. fill (changes in heights)
3. dodge (forces ggplot2 to not put things on top of each other)

- position = "identity" means you can place each object exactly where it falls in the context of the graph (good for scatter plots)
```{r}
#To alter transparency (alpha)
ggplot(data = diamonds, mapping = aes(x = cut, fill = clarity)) + 
  geom_bar(alpha = 1/5, position = "identity")

#To color the bar outlines with no fill color
ggplot(data = diamonds, mapping = aes(x = cut, colour = clarity)) + 
  geom_bar(fill = NA, position = "identity")
```
Example, position = "fill" makes each stacked bar the same height: 
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = "fill")
```
Example, position = "dodge" places overlapping objects directly BESIDE one another 
```{r}
ggplot(data = diamonds) + 
  geom_bar(mapping = aes(x = cut, fill = clarity), position = "dodge")
```
Example, position = "jitter" adds a small amount of random noise to each point to avoid overplotting when points overlap (useful for scatterplots, not bar graphs)
```{r}
ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), position = "jitter")
```
##2.13 The layered grammar of graphics 
This is the template for creating ggplots 
```{r}
ggplot(data = <DATA>)+ 
  <GEOM_FUNCTION>(
     mapping = aes(<MAPPINGS>)),
     stat = (<STAT>), 
     position = (<POSITION>) +
  <FACET_FUNCTION>
 
```
----------------------------------------------------

##Workshop 3: Ussing ggplot2 for communication 
##3.1 Labels 
Example, adding labels to ggplots are important for communicating what you are plotting. This eaxmple is inputting a title:
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  labs(title = "Fuel efficiency generally decreases with engine size")
```

Example, adding more text: 
- subtitle adds additional detail in a smaller font beneath the title and caption adds text at the bottom right of the plot 
- caption adds text at the bottom right of the plot, often used to describe the source of the
data.
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  labs(
    title = "Fuel efficiency generally decreases with engine size",
    subtitle = "Two seaters (sports cars) are an exception because of their light weight",
    caption = "Data from fueleconomy.gov"
  )
```

Example using labs() to replace axis label and legend titles: 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  geom_smooth(se = FALSE) +
  labs(
    x = "Engine displacement (L)",
    y = "Highway fuel economy (mpg)",
    colour = "Car type"
  )
```

##3.2 Annotations 
Adding text to the plot itself. 
- geom_text() to ad textual labels to plots 
- geom_point(), rather than a shape geometry it can add a label. 
- the "nudge()" function can be used to mave certain text around so that it isn't overlapping 

Example, adding a label that calls in the values from the data frame: 
```{r}
best_in_class <- mpg %>%
  group_by(class) %>%
  filter(row_number(desc(hwy)) == 1)

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  geom_text(aes(label = model), data = best_in_class)
```

##3.3 Scales 
ggplot2 automatically adds scales for you as seen below: 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class))
```
To tweak the scales you can do it by offering values to the scale parameters: 
- if you just add a number in the scale_x_continuous() brackets it only changes the label. But if you add in the breaks=seq then you can change the scale 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(colour = class)) +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +
  scale_y_continuous(breaks = seq(15, 50, by = 5)) +
  scale_colour_discrete(10)
```
##3.4 Axis ticks 
Example changing the ticks on the axes: 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point() +
  scale_y_continuous(breaks = seq(15, 40, by = 5))
```
##3.5 legens and colour schemes 
Example, changing the position of the legend using theme(): 
- Can also use legend.position = "none" to supress the display of the legend altogether 
```{r}
base <- ggplot(mpg, aes(displ, hwy))+
  geom_point(aes(colour = class))

base + theme(legend.position = "left")
```

```{r}
base <- ggplot(mpg, aes(displ, hwy))+
  geom_point(aes(colour = class))
base + theme(legend.position = "top")#can use this and change the position as a way to change the location of the legend
```
##3.6 Replacing a scale 
There are two types of scales that are most likely going to be used: contiuous position scales and colour sclaes 

Example, using logtransform to easily visualise data: 
```{r}
ggplot(diamonds, aes(carat, price))+
  geom_bin2d()+ 
  scale_x_log10(5)+ 
  scale_y_log10(10)
```

Example, changing the colour scale: 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = drv))

ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = drv)) +
  scale_colour_brewer(palette = "Set1")
```

Example, adding a redundant shape mapping (this helps to ensure the plot is interpretable in black and white): 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = drv, shape = drv)) +
  scale_colour_brewer(palette = "Set1")
```

Colours  http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/ 
- the above website is for more colour options off colorbrewer 

When there are predefined colours that you want to use the function scale_colour_manual() can be used:

```{r}
presidential %>%
  mutate(id = 33 + row_number()) %>%
  ggplot(aes(start, id, colour = party)) +
    geom_point() +
    geom_segment(aes(xend = end, yend = id)) +
    scale_colour_manual(values = c(Republican = "red", Democratic = "blue"))
```

Another colour scheme used is the viridis colour scheme: scale_colour_viridis()
- downloading the viridis package 
```{r}
install.packages('viridis')
install.packages('hexbin')
library(viridis)
library(hexbin)
```

```{r}
df <- tibble( # note we're just making a fake dataset so we can plot it
  x = rnorm(10000),
  y = rnorm(10000)
)
ggplot(df, aes(x, y)) +
  geom_hex() + # a new geom!
  coord_fixed()

ggplot(df, aes(x, y)) +
  geom_hex() +
  viridis::scale_fill_viridis() +
  coord_fixed()
```

##3.7 Themes 
Customising the entire theme of your plot 
- ggplot has 8 themes by default 
Example, the below graph is the BLACK AND WHITE, dark on light ggplot2 theme 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  theme_bw()
```

Example, the below graph has LIGHT GRAY lines and axes, to direct more attention to the data. 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  theme_light()
```
Example, the graph below is a CLASSIC theme with the x and y axis lines and no gridlines: 

```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  theme_classic()
```

Example, the graph below is the DARK THEME  
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
  theme_dark()
```

Example, you can develop your own themes by setting more arguments: 
- This is an example of one that has been tailored. 
```{r}
ggplot(mpg, aes(displ, hwy)) +
  geom_point(aes(color = class)) +
  geom_smooth(se = FALSE) +
theme (panel.border = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.minor.y = element_blank(),
        legend.position="bottom",
        legend.title=element_blank(),
        legend.text=element_text(size=8),
        panel.grid.major = element_blank(),
        legend.key = element_blank(),
        legend.background = element_blank(),
        axis.text.y=element_text(colour="black"),
        axis.text.x=element_text(colour="black"),
        text=element_text(family="Arial")) 
```

##3.8 Saving and exporting your plots 
There are two main ways to export your plots out of R: 
1. Using ggsave()
2. Or export with your code ising R markdown via knitr
```{r}
ggplot(mpg, aes(displ, hwy)) + geom_point()

ggsave("my-plot.pdf")
```

----------------------------------------------------------------
##4.0 Workshop 3: Reproducible work  
Below the code is installing Git
```{r}
install.packages("usethis")
library(usethis)
use_git_config(user.name = "hanna-shrubshall", user.email = "hanna.shrubshall@gmail.com")
```

##4.9.1 Pull
- Pulling a repository simply downloads it from the remote server onto the computer. 
##4.9.2 Stage 
Git stage prepares the file for committing it. 
- The files in the Git tab need to be ticked as standard, meaning you want the files to be sent to your remote repo when you go ahead and commit. 

##4.9.3 Commit 
This is the function that saves this 'version' of your repo into your repository's version history. 
-At this point you can write readable messages of what you've done to your repo. 

##4.9.4 Push 
This is the function that pushes your changes to the remote server 
-It's best practice to commit and push your code at the same time

